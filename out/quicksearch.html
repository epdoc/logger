<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"global.html":{"id":"global.html","title":"Global","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Global Members _gLogManager Global LogManager singleton format Utility formatting routines self Formatting routines that are used internally. Some of these may have external applications and can be accessed by the module's 'format' export property Methods get() Deprecated: Yes getLogger(name, context) Get a Logger object upon which logging calls can be made. Parameters: Name Type Description name string | Array.&lt;string&gt; Name of module. If an array, then joined by '.'. context Object Context object, with optional req and res properties. Returns: New Logger object Type Logger getLogListener(options) Unit test helper can be used in conjunction with callback transport. Parameters: Name Type Description options Returns: Type LogListener getLogManager(options) Return the global LogManager singleton. Will create the singleton if it does not already exist. Parameters: Name Type Description options Returns: Existing or new global LogManager object Type LogManager hasLogManager() Test if the global LogManager singleton has been initialized Returns: Do we have a global LogManager singleton? Type boolean hasLogMgr() Deprecated: Yes logListener() Deprecated: Yes logMgr() Deprecated: Yes middleware() Return Express Middleware. Example var reqId = require('logger').middleware().reqId; app.use(reqId()); Request(name, options) Stub for express.request object, used when passing request object around when simulating req/res/next flow. Parameters: Name Type Description name Define the name to use for your own 'locals' (private variables). options The object to attach to req[name], defaults to . Returns: A request object start() Shortcut to calling the global LogManager's start method. See: LogManager#start Returns: Type LogManager × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Modules Classes CallbackTransport ConsoleTransport FileTransport Logger LogglyTransport LogManager × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Classes Classes CallbackTransport ConsoleTransport FileTransport Logger LogglyTransport LogManager × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart epdoc-loggerA logging module supporting built-in and custom transports, Express 4 response mixins, rich message and data syntax, chainable methods for recording log events, and a callback transport to allow unit testing via log messages. Generally supports Winston's logging method calls for simpler messages, but with the addition of a number of new methods, many of which can be chained to create richer output with more columns of data. This page and API Reference are also formatted and available here. Installnpm install --save epdoc-loggerQuick StartLog to the consoleUse short cuts to begin logging. The variable log is a Logger object that is used to generate log messages. var log = require('epdoc-logger').start().getLogger(); log.info(&quot;Hello world&quot;);[&quot;00:00.001&quot;,&quot;INFO&quot;,0,&quot;&quot;,&quot;logger&quot;,&quot;logger.push.success&quot;,&quot;Set logger to Console&quot;,{},{&quot;transport&quot;:&quot;Console&quot;}] [&quot;00:00.015&quot;,&quot;INFO&quot;,0,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;Hello world&quot;,{}]ConfigureThe easiest way to use the logger is to create and initialize a LogManager object using config settings, then retrieve a Logger object from the LogManager. var config = require('config'); var elogger = require('epdoc-logger'); var logMgr = elogger.getLogManager(config.elogger).start(); var log = logMgr.get('emitter.name.goes.here'); log.action('say.hello').set({static1:'value1'}).info(&quot;Hello world&quot;);An example configuration, illustrating how transports are specified and configured. { &quot;elogger&quot;: { &quot;sid&quot;: true, &quot;static&quot;: true, &quot;transports&quot;: [&quot;console&quot;], &quot;level&quot;: &quot;info&quot;, &quot;console&quot;: { &quot;timestamp&quot;: &quot;iso&quot; }, &quot;loggly&quot;: { &quot;token&quot;: &quot;xxxxxxxx&quot; } } }Refer to LogManager#setOptions method for config object documentation. Manual ConfigurationBuffer messages until your logger is set up. var logMgr = require('epdoc-logger').getLogManager(); var log = logMgr.getLogger('main'); log.info(&quot;Starting application&quot;); var config = require('config.json'); logMgr.setTransport('file',{path:config.logFile,timestamp:'iso'}).start(); log.info(&quot;Hello world&quot;);[&quot;2016-03-29T04:19:45.920Z&quot;,&quot;INFO&quot;,&quot;main&quot;,&quot;&quot;,&quot;Starting application&quot;] [&quot;2016-03-29T04:19:45.922Z&quot;,&quot;INFO&quot;,&quot;logger&quot;,&quot;logger.push&quot;,&quot;Setting logger to File (/path/to/file.log)&quot;,{&quot;transport&quot;:&quot;File (/path/to/file.log)&quot;}] [&quot;2016-03-29T04:19:45.924Z&quot;,&quot;INFO&quot;,&quot;logger&quot;,&quot;logger.push.success&quot;,&quot;Set logger to File (/path/to/file.log)&quot;,{&quot;transport&quot;:&quot;File (/path/to/file.log)&quot;}] [&quot;2016-03-29T04:19:45.926Z&quot;,&quot;INFO&quot;,&quot;main&quot;,&quot;&quot;,&quot;Hello world&quot;]Log to loggly.com, buffering and making batch calls to loggly. var logMgr = require('epdoc-logger').getLogManager(); var log = logMgr.getLogger('main'); log.info(&quot;Starting application&quot;); logMgr.setTransport('loggly',{token:'MyToken'}); log.info(&quot;Hello world&quot;); // log a message count for all the different log levels logMgr.writeCount(); // Shutdown properly so loggly message buffer is flushed logMgr.destroying().then(function() { done(); }, function(err) { done(err); });ClassesThere are two main objects used for logging: LogManager Usually a singleton Used to configure the transports, set global options, buffer log messages until writing to transports is turned on, and start writing to the transports Can also be used to directly write to the transports (see LogManager#logParams and LogManager#logMessage) Logger A per-emitter object Advise is to create a new Logger object for every file (emitter), or for every request (e.g. express) Provides chainable methods by which to write log output You can directly access these two classes from the exported epdoc-logger module: var epdocLogger = require('epdoc-logger'); var LogManager = epdocLogger.LogManager; var Logger = epdocLogger.Logger;LogManager ClassA shortcut for getting a LogManager singleton is to call the module's getLogManager method. var logMgr = require('epdoc-logger').getLogManager();An alternative is to manage your own LogManager object: var epdocLogger = require('epdoc-logger'); var LogManager = epdocLogger.LogManager; var logMgr = new LogManager();Because you may need to load config information before configuring your transport you must explicitly start logging by calling LogManager#start. And, because some log tranports are buffered, you should also call LogManager#flushing or LogManager#destroying before shutting down. Logger ClassLogger objects are created by calling LogManager#getLogger or new Logger(). Typically you would create a new Logger object for every javascript file and set a unique emitter name for that Logger. Alternatively, when responding to requests, for example when using Express, it is a better idea to tie the emitter to the request. This is described later in this document. Loggers are created by calling LogManager#getLogger. var log = logMgr.getLogger('emitter-name'); // This is equivalent var log = new Logger(logMgr,'emitter-name'); // A shortcut that is also equivalent and that uses a global LogManager object var log = require('epdoc-logger').getLogger('emitter-name');TransportsThe module has built-in support for the following transports and can output to multiple transports at the same time. ConsoleTransport - logs to the console (default) FileTransport - logs to a file SOSTransport - Logs to SOS Max. SOS max is the POWERFLASHER Socket Output Server - a fast and helpful programmer tool with graphical user interface to display log messages for debugging purpose. Note that SOS Max appears to not work on the latest version of Mac OS X. CallbackTransport - A line buffer/callback transport useful for automated testing LogglyTransport - Logs to the online loggly.com service. ConfigurationOn startup the logger can wait for a transport to be initialized before starting to write log messages, or will begin writing log messages immediately when LogManager#autoRun is set to true. By default the logger uses the Console Transport and must be started manually. If LogManager#autoRun is not set, then a call to LogManager#start will begin logging. Messages are buffered prior to this method being called, so prior to this event no messages will be lost and there is time to configure transports. Transports are configured via properties passed to LogManager#addTransport, LogManager#setOptions or LogManager#constructor. Transport configuration properties are passed directly to the transport. Refer to the individual transport API reference documents for more information. Multiple transports can be configured to be run at the same time. Logging to ConsoleMain File var gLogMgr = require('epdoc-logger').getLogManager().start(); var log = gLogMgr.getLogger('main'); log.info(&quot;Return value for %s is %s&quot;, &quot;hello&quot;, &quot;world&quot; ); log.data('req',{a:3}).info(); log.data('res',{b:4}).info(&quot;My message with %s support&quot;, 'formatting');Other js files var log = require('epdoc-logger').getLogger('other'); log.info(&quot;Hello world&quot;);Console and File transport output is in one of the following formats: jsonArray (default) - An array of JSON values (see example below) json - A JSON object with key/value pairs for the output function - Provide your own function to format the output string - Template-based output with optional colorization (Console only) These formats are specified as options when constructing the transport. Refer to the transport documentation for more details. JSON array format looks like this [&quot;00:00.000&quot;,&quot;INFO&quot;,&quot;logger&quot;,&quot;logger.transport.add&quot;,&quot;Added transport 'Console'&quot;,{&quot;transport&quot;:&quot;Console&quot;}]and has array entries for [ timestamp, level, reqId, sid, emitter, action, message, static, data ]. The reqId and sid fields only output if the transport sid option is true. The static field is only output if the transport static option is true. Logging to a FileThis shows the more hands-on use of the Logger object to set transports. var gLogMgr = require('epdoc-logger').getLogManager(); gLogMgr.setTransport( 'file', { path: 'path/to/myfile.log' } ); var log = gLogMgr.getLogger('MyModule'); log.info(&quot;Return value for %s is %s&quot;, &quot;hello&quot;, &quot;world&quot; ); log.data('req',{a:3}).info(); log.data('res',{b:4}).info(&quot;My message with %s support&quot;, 'formatting');Logging to SOSWhen you set the logger to SOS the setLogger method returns immediately, but the socket takes awhile to initialize. In the meantime log messages are queued up and getLogger() returns the SOS logger. Once the connection is made the messages are flushed. If the connection is refused the messages are flushed to the previously set logger output (usually the console). var logMgr = require('epdoc-logger').getLogManager({autoRun:false}); logMgr.setTransport( { type: 'sos', bIncludeSessionId: false } ); var log = logMgr.getLogger('MyModule'); log.info(&quot;Return value for %s is %s&quot;, &quot;hello&quot;, &quot;world&quot; );Logging to LogglyLoggly output is buffered and sent in batches. As a result it is important to shutdown logging before exiting. See the example earlier in this readme showing how the destroying method is used to get this done. Logging to CallbackThe Callback transport can be used in unit tests. By listening for your log messages, you can test whether your code is progressing correctly. Closing TransportsTransports can be closed using LogManager#removeTransport, or can sometimes close on their own. The Logger will buffer messages while switching transports, however individual transports can do their own buffering (e.g. file and loggly). If a transport closes prematurely, it's buffer may be lost. Logging Example// Get the global logger object var logMgr = require('../index').getLogManager({sid:false}); // Logger static methods logMgr.addTransport( 'file', { path: 'path/to/myfile.log', dateFormat: 'ISO', sid: false } ); var loggerType = logMgr.getTransports()[0].type(); logMgr.setLevel( 'warn' ); var startTime = logMgr.getStartTime(); // Milliseconds // Get a Logger object for this file or module var log = logMgr.start().getLogger('MyClassName'); // Instance methods. Each line outputs a message. log.data('a',1).data('b',[2,3]).info(); log.data({a:1,b:[2,3]}).info(&quot;My message&quot;); log.info( &quot;I just want to say %s to the %s&quot;, &quot;Hello&quot;, &quot;World&quot; ); log.action('obj.update').debug( &quot;We %s formatted messages&quot;, &quot;do&quot; ); log.error( new Error(&quot;My error&quot;) ); log.verbose( &quot;The default is to not output verbose messages, so this will not by default be output&quot; ); log.warn( &quot;Danger Will Robinson, danger&quot; ); log.fatal( &quot;Restarting server in %d seconds&quot;, 10 ); // Outputs a new message log.date(); // Output now's date/time log.separator(); // Output a line separator log.log( 'info', &quot;This method %s supports util.format style formating&quot;, &quot;also&quot; ); // Enable verbose messages to be output for this log object (overrides global setting) log.setLevel( &quot;verbose&quot; );Logger Method ChainingMost Logger methods support chaining. The following methods all add column values to the message that is output but do not output the message: action - Sets the action column value to this string. data - Sets the data column value. Either pass in a key value pair, which is then added to the data object, or an object, which the data object is then set to. set - Sets a value in a custom column and keeps this value for the duration of the Log object's lifespan. This column is currently only output to the loggly transport. The following methods result in a message being output with the corresponding log level set: info warn debug verbose error fatal The following methods result in a message output with log level set to INFO: separator - Output a separator line containing # characters date - Outputs localtime, utctime and uptime log - Outputs level and string message, for example: log.log( 'info', &quot;Found %d lines&quot;, iLines ). level - Optional level (defaults to info) msg - String to output, formatted with util.format Log LevelsLog level defaults are set in LogManager#constructor: this.LEVEL_DEFAULT = 'debug'; // Default threshold level for outputting logs this.LEVEL_INFO = 'info'; // If changing LEVEL_ORDER, what level should internally generated info messages be output at? this.LEVEL_WARN = 'warn'; // If changing LEVEL_ORDER, what level should internally generated warn messages be output at? this.LEVEL_ORDER = ['verbose', 'debug', 'info', 'warn', 'error', 'fatal'];You can customize log levels by setting the value of this array after constructing your LogManager object. Any subsequently created Logger objects will have methods with the names you have provided. Please use lowercase log level names. They will be changed to uppercase by transports, where appropriate. The level at which messages are output can be controlled at three points: Logger#constructor or Logger#setLevel - This log level will override log levels set by the LogManager LogManager#constructor or LogManager#setLevel - This becomes the default log level for all Logger objects and transports. At the Transport level by passing in the option level. This will override the value set for the LogManager. Express MiddlewareThe included express middleware are instantiated as follows: var middleware = require('epdoc-logger').middleware(); var app = express(); app.use(middleware.reqId()); app.use(app.router); app.all('*', middleware.responseLogger()); app.all('*', middleware.routeSeparator()); app.all('*', middleware.routeLogger());See test/app.express.js for an example of how to use a stub request and response method to test middleware. This technique can also be useful if you wish to use the req/res/next mechanism in non-express environments. As an example, you could have req/res objects for tracking AMQP (RabbitMQ) or AWS SQS requests and associating request or session IDs. ReqIdAdds _reqId and _hrStartTime to the request object. These are used later when logging. ResponseLoggerThe responseLogger middleware mixes custom logging methods, similar to those in the logging object, into the express response object. This will add request-context-sensitive logging information to each log message. As with the logging object, most methods can be chained. An example usage: function myFunction(req,res,params) { res.pushRouteInfo('myFunction'); res.action('complete').data(params).info('Entering function'); res.popRouteInfo(); }RouteSeparatorAdds a separator line to the log file for each new route. RouteLoggerAdds an information line to the log file for each new route. Action Items Add koa middleware (I don't currently have a koa project going, so this may not happen for awhile) More unit tests Document and add unit tests for LogListener, an object that makes it easier to use log the callback transport in unit tests. Update SOS transport as a general HTTP transport and rename to 'http' transport (beware). AuthorJim Pravetz jpravetz@epdoc.com Includes console colorize code from Winston. LicenseMIT × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"CallbackTransport.html":{"id":"CallbackTransport.html","title":"Class: CallbackTransport","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Class: CallbackTransport CallbackTransport new CallbackTransport(options) Create a new Callback transport where output is added to a data array or a callback is used to pass thru the log message. Used for testing. Parameters: Name Type Description options Object Output options include: Properties Name Type Argument Description sid boolean &lt;optional&gt; If true then output express request and session IDs, otherwise do not output these values level string &lt;optional&gt; Log level above which to output log messages, overriding setting for LogManager. callback function &lt;optional&gt; Callback with object to be logged rather than adding to line buffer uid function &lt;optional&gt; Unique identifier used by CallbackTransport#match. Methods clear() Used to clear the logger display. This is applicable only to certain transports, such as socket transports that direct logs to a UI. match(transport) Test if the transport matches the argument. Parameters: Name Type Description transport string | object If a string, then matches if equal to 'callback'. If an object, then matches if transport.type equals 'callback' and if transport.uid matches. Returns: True if the transport matches the argument Type boolean ready() Return true if this logger is ready to accept write operations. Otherwise the caller should buffer writes and call write when ready is true. Returns: Type boolean write(params) Write a log line Parameters: Name Type Description params Object Parameters to be logged: Properties Name Type Description time Date Date object level string log level (INFO, WARN, ERROR, or any string) reqId string express request ID, if provided (output if options.sid is true) sid string express session ID, if provided (output if options.sid is true) emitter string name of file or module or emitter (noun) action string method or operation being performed (verb) message string text string to output static Object Arbitrary data to be logged in a 'static' column if enabled via the LogManager. data Object Arbitrary data to be logged in the 'data' column × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"ConsoleTransport.html":{"id":"ConsoleTransport.html","title":"Class: ConsoleTransport","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Class: ConsoleTransport ConsoleTransport new ConsoleTransport(options) Create a new Console transport to output log messages to the console. Parameters: Name Type Description options Object Output options include: Properties Name Type Argument Default Description sid Boolean &lt;optional&gt; If true then output express request and session IDs, otherwise do not output these values colorize Boolean &lt;optional&gt; true Set to true to enable colorize formatted output. template String &lt;optional&gt; Provide a template string to use for output when options.format is 'string', substitutes ${ts} %{level} ${emitter} type strings, where '%' indicates string should be colorized. timestamp String &lt;optional&gt; ms Set the format for timestamp output, must be one of 'ms' or 'iso'. format String | function &lt;optional&gt; jsonArray Set the format for the output line. Must be one of 'json', 'jsonArray', 'string', or a function that takes params and options as parameters. static Boolean &lt;optional&gt; true Set whether to output a 'static' column. level String &lt;optional&gt; Log level above which to output log messages, overriding setting for LogManager. Methods clear() Used to clear the logger display. This is applicable only to certain transports, such as socket transports that direct logs to a UI. match(transport) Test if the transport matches the argument. Parameters: Name Type Description transport string | object If a string then matches if equal to 'console'. If an object then matches if transport.type equals 'console'. Returns: True if the transport matches the argument Type boolean ready() Return true if this logger is ready to accept write operations. Otherwise the caller should buffer writes and call write when ready is true. Returns: Type boolean write(params) Write a log line Parameters: Name Type Description params Object Parameters to be logged: Properties Name Type Description time Date Date object level string log level (INFO, WARN, ERROR, or any string) reqId string express request ID, if provided (output if options.sid is true) sid string express session ID, if provided (output if options.sid is true) emitter string name of file or module or emitter (noun) action string method or operation being performed (verb) message string text string to output static Object Arbitrary data to be logged in a 'static' column if enabled via the LogManager. data Object Arbitrary data to be logged in the 'data' column × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"FileTransport.html":{"id":"FileTransport.html","title":"Class: FileTransport","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Class: FileTransport FileTransport new FileTransport(options) Create a new File transport to output log messages to a file. Parameters: Name Type Description options Object Output options include: Properties Name Type Argument Default Description sid boolean &lt;optional&gt; If true then output express request and session IDs, otherwise do not output these values path string The path to the output file to append to. timestamp string &lt;optional&gt; ms Set the format for timestamp output, must be one of 'ms' or 'iso'. format String | function &lt;optional&gt; jsonArray Set the format for the output line. Must be one of 'json', 'jsonArray', 'string', or a function that takes params and options as parameters. template String &lt;optional&gt; Provide a template string to use for output when options.format is 'string', substitutes ${ts} %{level} ${emitter} type strings, where '%' indicates string should be colorized. static boolean &lt;optional&gt; true Set whether to output a 'static' column. level string &lt;optional&gt; Log level above which to output log messages, overriding setting for LogManager. Methods clear() Used to clear the logger display. This is applicable only to certain transports, such as socket transports that direct logs to a UI. flush() Used only if buffering (if options.buffer is &gt; 0) Flushes everything in the buffer and starts a timer to automatically flush again after options.buffer time match(transport) Test if the transport matches the argument. Parameters: Name Type Description transport string | object If a string then matches if equal to 'file'. If an object then matches if transport.type equals 'file' and transport.path equals this transports path property. Returns: True if the transport matches the argument Type boolean ready() Return true if this logger is ready to accept write operations. Otherwise the caller should buffer writes and call write when ready is true. Returns: Type boolean write(params) Write a log line Parameters: Name Type Description params Object Parameters to be logged: Properties Name Type Description time Date Date object level string log level (INFO, WARN, ERROR, or any string) reqId string express request ID, if provided (output if options.sid is true) sid string express session ID, if provided (output if options.sid is true) emitter string name of file or module or emitter (noun) action string method or operation being performed (verb) message string text string to output static Object Arbitrary data to be logged in a 'static' column if enabled via the LogManager. data Object Arbitrary data to be logged in the 'data' column × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"Logger.html":{"id":"Logger.html","title":"Class: Logger","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Class: Logger Logger A Logger object has methods to write log information to a specified transport. The line below shows sample output when writting to the Console transport. [&quot;00:03.767&quot;,&quot;INFO&quot;,0,&quot;&quot;,&quot;main&quot;,&quot;app.initialized&quot;,&quot;We've initialized the app&quot;,{&quot;process&quot;:{&quot;pid&quot;:12345}}] For the above output, time is since this module was first initialized and is shown in milliseconds. This is followed by the log level, request ID, session ID, module/emitter name, action, message and arbitrary data. The format of the output is determined by the transport and it's settings. new Logger(logMgr [, emitter] [, context]) Create a new log object with methods to log to the transport that is attached to logMgr. This log object can be attached to another object, for example an Express request object, in order to pass the log object down through a calling stack. If a context is passed in, various properties may be harvested off of the req property. These include: req._reqId (populates reqId column), req.sid (uses req.session.id or req.sessionId and populates sid column), req._startTime and req._hrStartTime (either can be used to determine the response time for a request). Parameters: Name Type Argument Description logMgr LogManager The parent LogManager object that specifies the transport and provides lower-level output methods emitter string | Array.&lt;string&gt; &lt;optional&gt; The name of the module or emitter that is emitting the log message, used to populate the emitter output column. This can be modified to show method call hierarchy by calling pushName and popName. context object &lt;optional&gt; A context object. For Express or koa this would have req and res properties. Examples // Create a new Logger object step by step var EpdocLogger = require('epdoc-logger'); var LogManager = EpdocLogger.LogManager; var Logger = EpdocLogger.Logger; var logMgr = new LogManager(); var log = new Logger(gLogMgr,'logtest'); // Create a new Logger object the easy way using global LogManager. var log = require('epdoc-logger').get('logtest'); Methods action(arguments) Set the value of the action column. Action is a unique column in the log output and is a machine-searchable verb that uniquely describes the type of log event. Parameters: Name Type Argument Description arguments string &lt;repeatable&gt; Single string or multiple strings that are then joined with a '.'. Returns: The Logger object Type Logger Example log.action('message.sent').info(&quot;Message has been sent&quot;); data(key [, value]) Set a property or multiple properties in the data column. Parameters: Name Type Argument Description key string | object If a string then sets data[key] to value. Otherwise extend the object data with the object key. value string &lt;optional&gt; If key is a string then sets data[key] to this value. Returns: Type Logger Example log.data('a',3).data('b',4).info(); log.data({a:3,b:4}).info(); elapsed() Used to measure the duration of requests or other events. Add an 'elapsed' attribute to data being output, which is the time since this request object was initialized. Requirement: One of the following three must be initialized: 1. request object must set it's _delayTime 2. request object must set it's _startTime (ms) 3. must have called resetElapsed() to reset this.t0 Returns: this Type Object errorStack( [bShow]) Set whether to log a stack for Error objects. If not set in the constructor, then inherits this value from the LogManager. Parameters: Name Type Argument Default Description bShow boolean &lt;optional&gt; true Returns: Type Logger getHrElapsed() High resolution response time. Returns the response time in milliseconds with two digits after the decimal. Returns: Response time in milliseconds Type number getLevel() Get the log level for this object Returns: The currently set log level for this Logger object. Type string hrElapsed( [key]) Adds the High Resolution response time to the data column. Parameters: Name Type Argument Default Description key string &lt;optional&gt; elapsed Name of property in the data column. Returns: Self. Type Logger isAboveLevel(level) Test if the given level is above the log level set for this Logger object. Parameters: Name Type Description level string Must be one of LogManager.LEVEL_ORDER. Returns: True if the level is equal to or greater then the reference, or if reference is null. Type boolean log( [level], msg) Output a log message, specifying the log level as the first parameter, and a string with util.format syntax as a second parameter, for example myLogger.log('info', 'test message %s', 'my string'); The second parameter can optionally be an array of strings or arrays, each one of which will be treated as input to util.format. This is useful for logMgrs that support folding (muli-line output). Example: log.log( 'info', [[&quot;Found %d lines&quot;, iLines],&quot;My second line&quot;,[&quot;My %s line&quot;,'third']]); ); Parameters: Name Type Argument Default Description level string &lt;optional&gt; info One of Logger.LEVEL_ORDER. Defaults to `info` if not present. msg string The message String, or an array of strings, to be formatted with util.format. logObj(key [, value]) Log a key,value or an object. If an object the any previous logged objects are overwritten. If a key,value then add to the existing logged object. Objects are written when a call to info, etc is made. Parameters: Name Type Argument Description key string | number | object If a string or number then key,value is added, else the object ```key``` is added value &lt;optional&gt; If key is a string or number then data.key is set to value Deprecated: Use ```data``` method instead. Returns: Type Logger logParams(params) Log a raw message in the spirit of Logger.logMessage, adding sid and reqId columns from this.ctx.req Looks for sessionID in req.session.id or req.sessionId, otherwise uses the passed in values for sid and reqId (if any). This is the method that calls the underlying logging outputter. If you want to use your own logging tool, you can replace this method, or provide your own transport. Parameters: Name Type Description params Returns: Type * popName(options) See pushRouteInfo. Should be called if returning back up a function chain. Does not need to be called if the function terminates the request with a response. Parameters: Name Type Description options Available options are 'all' if all action contexts are to be removed from the _logging stack. See: Logger#pushName Returns: Response object pushName(name) A method to add context to the method stack that has gotten us to this point in code. The context is pushed into a stack, and the full stack is output as the module/emitter property of the log message. This method is usually called at the entry point of a function. Can also be called by submodules, in which case the submodules should call popName when returning. Note that it is not necessary to call popName when used in the context of an Express context and terminating a request with a response. Parameters: Name Type Description name (required) String in the form 'api.org.create' (route.method or route.object.method). See: Logger#popName Returns: Response object resetElapsed() Reset the elapsed time timer. Returns: Self Type Logger separator() Log a separator line that contains a message with '#' characters. Returns: Type Logger set(key, value) Set static data that is output in a separate column called static`. This column must be specifically enabled via the LogManager constructor's static option. Static data is not cleared when a log message is written, and so persists for the life of the log object. Parameters: Name Type Description key String | object If a string then sets staticData.key = value, otherwise extends staticData with key value * (Optional) Set key to this value Returns: Type Logger setLevel(level) Set the log level for this object. This overrides the global log level for this object. Parameters: Name Type Description level string Must be one of LogManager.LEVEL_ORDER. Returns: Self Type Logger × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"LogglyTransport.html":{"id":"LogglyTransport.html","title":"Class: LogglyTransport","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Class: LogglyTransport LogglyTransport new LogglyTransport(options) Create a new Loggly transport to output log messages to loggly. Parameters: Name Type Description options Object Output options include: Properties Name Type Argument Default Description sid boolean &lt;optional&gt; If true then output express request and session IDs, otherwise do not output these values level string &lt;optional&gt; Log level above which to output log messages, overriding setting for LogManager. token string The loggly token used for authenticating to loggly. tags Array.&lt;string&gt; &lt;optional&gt; Array of loggly tags. url string &lt;optional&gt; URL to use for the loggly service. Should be set only if the default URL value is not working. host string &lt;optional&gt; os.hostname() Set the name of the host that is reported to loggly in a host column. timestamp string &lt;optional&gt; ms Set the format for timestamp output, must be one of 'ms' or 'iso'. static boolean &lt;optional&gt; true Set whether to output a 'static' column. bufferSize number &lt;optional&gt; 100 The maximum number of lines of log messages to buffer before writing to loggly. flushInterval number &lt;optional&gt; 5000 The maximum number of milliseconds of buffering before writing to loggly. Methods clear() Used to clear the logger display. This is applicable only to certain transports, such as socket transports that direct logs to a UI. match(transport) Test if the transport matches the argument. Parameters: Name Type Description transport string | object If a string then matches if equal to 'loggly'. If an object then matches if transport.type equals 'loggly' and transport.token equals this transports token property. Returns: True if the transport matches the argument Type boolean ready() Return true if this logger is ready to accept write operations. Otherwise the caller should buffer writes and call write when ready is true. Returns: Type boolean write(params) Write a log line Parameters: Name Type Description params Object Parameters to be logged: Properties Name Type Description time Date Date object level string log level (INFO, WARN, ERROR, or any string) reqId string express request ID, if provided (output if options.sid is true) sid string express session ID, if provided (output if options.sid is true) emitter string name of file or module or emitter (noun) action string method or operation being performed (verb) message string text string to output static Object Arbitrary data to be logged in a 'static' column if enabled via the LogManager. data Object Arbitrary data to be logged in the 'data' column × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"LogManager.html":{"id":"LogManager.html","title":"Class: LogManager","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Class: LogManager LogManager A LogManager is used to manage logging, including transports, startup, shutdown and various options. new LogManager() Create a new LogManager object with no transports. Logged messages will not begin writing to the transport until a transport is added and start() is called. Pass in configuration options to configure the logger and transports. To manually add a transport call addTransport(). More than one transport can be configured at the same time. Alternatively the LogManager can be started up immediately by setting options.autoRun to true. In this situation, if options.transports is set, then the specified transports will be used. But if options.transports is not set, then the default ConsoleTransport is used. It is normal to have one LogManager per application, and to call get(emitterName) to get a new Logger object for each emitter and then call methods on this Logger object to log messages. Refer to LogManager#setOptions for options documentation. Methods addTransport( [type], options) Add a log transport. Multiple transports can be in operation at the same time, allowing log messages to be sent to more than one destination. Parameters: Name Type Argument Description type string | Object &lt;optional&gt; For the provided loggers, one of 'sos', 'file', 'callback', 'console' or 'loggly'. For a custom transport this should be a transport class object that can be instantiated with 'new'. To create your own transport class, consider using getLoggerClass('console') and then subclassing this class. If the params option contains a 'type' property, this field is optional. options Object These are directly passed to the transport when constructing the new transport object. Please refer to the individual transport for properties. Some common properties are listed here. Properties Name Type Argument Default Description sid boolean &lt;optional&gt; If true then output express request and session IDs, otherwise do not output these values. Default is to use LogManager's sid setting. timestamp string &lt;optional&gt; ms Set the format for timestamp output, must be one of 'ms' or 'iso'. static boolean &lt;optional&gt; true Set whether to output a 'static' column. By default this inherits the value from the LogManager. level string &lt;optional&gt; debug Log level for this transport. Returns: Type LogManager destroying( [callback]) Performs a managed shutdown of the logging service. This is relevant if using a buffered logger such as the loggly transport. If called when shutting down an application, the caller should wait for buffers to be flushed and the callback to be called before exiting. Parameters: Name Type Argument Description callback function &lt;optional&gt; Called with err when complete. Returns: Type Promise errorStack( [bShow]) Set whether to show an error stack as data when an Error is encountered. This option can also be set in the LogManager constructor. The property is referenced by Logger objects when they are created, and is used by the Logger to determine whether to output an error stack trace in the data column when an Error is logged. Parameters: Name Type Argument Default Description bShow boolean &lt;optional&gt; true Set whether to log the call stack for logged errors. Returns: Type LogManager flushing( [callback]) Flush the buffers for all transports. Parameters: Name Type Argument Description callback function &lt;optional&gt; Called with err when complete. Returns: Type Promise get() Deprecated: Yes getCount() Return a count object containing a count of the number of log messages produced at the various log levels defined in LogManager#LEVEL_ORDER. Returns: with properties for 'warn', 'info', etc. where the value of each property is a number. Type Object getLogger(emitter [, context]) Return a new Logger object with the specified emitter name. Although it's a new logger instance, it still uses the same underlying 'writeMessageParams' method, and whatever transport is set globally by this LogManager. Parameters: Name Type Argument Description emitter string Name of emitter, module or file, added as a column to log output context object &lt;optional&gt; A context object. For Express or koa this would have 'req' and 'res' properties. The context.req may also have reqId and sid/sessionId/session.id properties that are used to populate their respective columns of output. Otherwise these columns are left blank on output. Returns: A new object. Type logger getStartTime() Get the time at which the app or this module was initialized Returns: Start time in milliseconds Type Number getTransportByName() Return one of the predefined transport classes by name. If you want to define your own class, it is suggested you subclass or copy one of the existing transports. Returns: LogManager Class for which you should call new with options, or if creating your own transport you may subclass this object. Type * getTransports() Get the list of currently set transports. Returns: The current array of transports. Call type() on the return value to determine it's type. Type * isAboveLevel(level [, thresholdLevel]) Return true if the level is equal to or greater then the LogManager#logLevel property. Parameters: Name Type Argument Description level string Level that is to be tested thresholdLevel string &lt;optional&gt; Threshold level against which level is to be tested. If this is not supplied then the level will be tested against LogManager#logLevel. Returns: Type boolean isValidTransport(s) Test if this is a known transport Parameters: Name Type Description s string Name of the transport Returns: Type boolean logMessage(level, action, message [, data]) A wrapper for logParams with a more limited set of properties. Parameters: Name Type Argument Description level string action string message string data Object &lt;optional&gt; See: {LogManager#logParams} Returns: Type LogManager logParams(msgParams) Write a raw message to the transport. The LogManager will buffer messages to handle the situation where we are switching transports and the new transport is not yet ready. It is possible to log directly to a transport using this method and never need to create a Logger object. Parameters: Name Type Description msgParams Object The message to be written Properties Name Type Argument Default Description level string &lt;optional&gt; info Must be one of LEVEL_ORDER values, all lower case sid string &lt;optional&gt; sessionID to display emitter string &lt;optional&gt; Module or emitter descriptor to display (usually of form route.obj.function) time string &lt;optional&gt; now A date object with the current time timeDiff string &lt;optional&gt; calculated The difference in milliseconds between 'time' and when the application was started, based on reading LogManager#getStartTime message string | Array.&lt;string&gt; A string or an array of strings. If an array the string will be printed on multiple lines where supported (e.g. SOS). The string must already formatted (e.g.. no '%s') Returns: Type LogManager removeTransport(transport [, callback]) Remove a particular transport. Pauses log output. The caller should call start() to restart logging. Parameters: Name Type Argument Description transport string | object If a string then all transports of this type will be removed. If an object then all transports that match the object specification will be removed. Refer to the individual classes' match method. callback function &lt;optional&gt; The caller can wait for transports to be flushed and destroyed, but this is not necessary for normal use. Returns: Type LogManager setLevel(level [, options]) Set the LogManager objects's minimum log level. Parameters: Name Type Argument Description level string Must be one of LogManager#LEVEL_ORDER options Object &lt;optional&gt; Properties Name Type Argument Default Description transports Boolean &lt;optional&gt; false Set the level for all transports as well. Returns: Type LogManager setOptions( [options]) Setup LogManager and transports based on config. Parameters: Name Type Argument Description options Object &lt;optional&gt; Configuration information, can be from a configuration file Properties Name Type Argument Default Description t0 Date &lt;optional&gt; now The earliest known time for when the process was started sid boolean &lt;optional&gt; false Indicates whether a session ID column should be included in log output static boolean &lt;optional&gt; false Indicates whether a static column should be included in log output level string &lt;optional&gt; debug The log level at and above which log messages will be written errorStack boolean &lt;optional&gt; false Include the error stack in the data column when writing Error objects to the log. transports Array.&lt;Object&gt; &lt;optional&gt; Add transports now rather than calling {#addTransport}. Objects in the array contain the config for the transport and must include a type property. autoRun boolean &lt;optional&gt; false If set to true then logging will be immediately enabled and a call to LogManager#start will not be necessary. If no transports have been provided then a default console transport will be added. allTransportsReady boolean &lt;optional&gt; true If true then all transports must be ready before messages will be written. If false then any transport can be ready before flushing will occur, which may result in transports that are not ready missing some messages. setStartTime(d) Set automatically when the epdoc-logger module is initialized, but can be set manually to the earliest known time that the application was started. Parameters: Name Type Description d Date The application start time Returns: Type LogManager start( [callback]) Starts all transports, if not already started. This enables logs to be written to the transports. It is necessary to manually start the transports if not using the default transport, to allow time for the transports to be setup. Log messages will be buffered until all transports are ready. If there are no transports configured then this method will add the console transport to ensure that there is at least one transport. Parameters: Name Type Argument Description callback function &lt;optional&gt; Called when all transports are ready to receive messages. It is not normally necessary to wait for this callback. Returns: Type LogManager starting() Wraps {LogManager#start} into a Promise. Returns: Resolves to this. Type Promise writeCount( [message]) Write a log line to the transport with a count of how many of each level of message has been output. This is a useful function to call when the application is shutdown. Parameters: Name Type Argument Description message string &lt;optional&gt; Returns: Type LogManager × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"module-middleware_reqId.html":{"id":"module-middleware_reqId.html","title":"Module: middleware/reqId","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Module: middleware/reqId Express middleware adds a unique id _reqId and high-resolution start time _hrStartTime to the request object. The high-resolution start time uses process.hrtime(). Members &lt;inner&gt; reqId Request ID, unique for this process, incremented from 0 for every new request. Methods &lt;inner&gt; routeSeparator() Return middleware that adds a unique id _reqId and high-resolution start time _hrStartTime to the express request object Returns: Function that can be called to add middleware to an express application. Type function Example var middleware = require('epdoc-logger').middleware(); var app = express(); app.use(middleware.reqId()); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"module-middleware_responseLogger.html":{"id":"module-middleware_responseLogger.html","title":"Module: middleware/responseLogger","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Module: middleware/responseLogger Express middleware extends express.js response object by adding a Logger object via which logging can be done in the context of the request. Also extends response.send and response.end methods to automatically log a message when a response is sent. This message will include the response time for the request. Methods &lt;inner&gt; responseLogger( [options]) Return middleware that can add a Logger object to the express response object. Parameters: Name Type Argument Description options Object &lt;optional&gt; Properties Name Type Argument Default Description objName string &lt;optional&gt; log The name of the response object property to which to attach the Logger object. Returns: Function that can be called to add middleware to an express application. Type function Example var middleware = require('epdoc-logger').middleware(); app.all('*', middleware.responseLogger()); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:06-07:00 using the DocStrap template. "},"module-middleware_routeLogger.html":{"id":"module-middleware_routeLogger.html","title":"Module: middleware/routeLogger","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Module: middleware/routeLogger Express middleware outputs a log message for every route. Depends on responseLogger being installed, must be added after the router. Methods &lt;inner&gt; routeLogger() Return middleware that outputs a log message for every new request. The log message is output via a Logger object that is attached to the express response object using the responseLogger middleware. Returns: Function that can be called to add middleware to an express application. Type function Example var middleware = require('epdoc-logger').middleware(); app.all('*', middleware.responseLogger()); app.all('*', middleware.routeLogger()); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:07-07:00 using the DocStrap template. "},"module-middleware_routeSeparator.html":{"id":"module-middleware_routeSeparator.html","title":"Module: middleware/routeSeparator","body":" Documentation Modules middleware/reqIdmiddleware/responseLoggermiddleware/routeLoggermiddleware/routeSeparator Classes CallbackTransportConsoleTransportFileTransportLoggerLogglyTransportLogManager Global _gLogManagerformatgetgetLoggergetLogListenergetLogManagerhasLogManagerhasLogMgrlogListenerlogMgrmiddlewareRequestselfstart Module: middleware/routeSeparator Express middleware outputs a log message with a separator and date for every route. Depends on the responseLogger middleware, and must be added after the router. Methods &lt;inner&gt; routeSeparator() Return middleware that outputs a log message for every new request. The log message is output via a Logger object that is attached to the express response object using the responseLogger middleware. Returns: Function that can be called to add middleware to an express application. Type function Example var middleware = require('epdoc-logger').middleware(); app.all('*', middleware.responseLogger()); app.all('*', middleware.routeSeparator()); × Search results Close Documentation generated by JSDoc 3.4.0 on 2016-08-20T18:52:07-07:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
